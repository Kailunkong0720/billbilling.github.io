<!DOCTYPE html>

<!--
 // WEBSITE: https://themefisher.com
 // TWITTER: https://twitter.com/themefisher
 // FACEBOOK: https://www.facebook.com/themefisher
 // GITHUB: https://github.com/themefisher/
-->

<html lang="en" dir="ltr">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>多多益善</title>
  
  <!-- GOOGLE FONTS -->
  <link href="https://fonts.googleapis.com/css?family=Karla:400,700|Roboto" rel="stylesheet">
  <link href="plugins/material/css/materialdesignicons.min.css" rel="stylesheet" />
  <link href="plugins/simplebar/simplebar.css" rel="stylesheet" />

  <!-- PLUGINS CSS STYLE -->
  <link href="plugins/nprogress/nprogress.css" rel="stylesheet" />
  
  
  
  
  <link href="plugins/jvectormap/jquery-jvectormap-2.0.3.css" rel="stylesheet" />
  
  
  
  
  
  <link href="plugins/daterangepicker/daterangepicker.css" rel="stylesheet" />
  
  
  <!-- MONO CSS -->
  <link id="main-css-href" rel="stylesheet" href="css/style.css" />

  


  <!-- FAVICON -->
  <link href="images/favicon.png" rel="shortcut icon" />

  <!--
    HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
  -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  <script src="plugins/nprogress/nprogress.js"></script>
  <script src="https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js"></script>
</head>


  <body class="navbar-fixed sidebar-fixed" id="body">
    <script>
      NProgress.configure({ showSpinner: false });
      NProgress.start();
    </script>

    

    <!-- ====================================
    ——— WRAPPER
  =========================================-->
  <div class="wrapper">
      
      
    <!-- ====================================
      ——— LEFT SIDEBAR WITH OUT FOOTER
    ===================================== -->
    <aside class="left-sidebar sidebar-dark" id="left-sidebar">
      <div id="sidebar" class="sidebar sidebar-with-footer">
        <!-- Aplication Brand -->
        <div class="app-brand">
          <a href="/index.html">
            <img src="images/main_icon.png" alt="Mono" width="30%">
            <span class="brand-name">多多益善</span>
          </a>
        </div>
        <!-- begin sidebar scrollbar -->
        <div class="sidebar-left" data-simplebar style="height: 100%;">
          <!-- sidebar menu -->
          <ul class="nav sidebar-inner" id="sidebar-menu">
            

             
            <li
          
            >
            
                <a class="sidenav-item-link" href="index.html">
                  <i class="mdi mdi-briefcase-account-outline"></i>
                  <span class="nav-text">總覽</span>
                </a>
              </li>
            

            

            
              <li
              class="active"
               >
                <a class="sidenav-item-link" href="createBill.html">
                  <i class="mdi mdi-chart-line"></i>
                  <span class="nav-text">新增帳單</span>
                </a>
              </li>
            <li>
                    <a class="sidenav-item-link" href="game.html">
                      <i class="mdi mdi-chart-line"></i>
                      <span class="nav-text">新增目標</span>
                    </a>
                  </li>

                  <li class="section-title">
                    User
                  </li>
                

                  <li>
                    <a class="sidenav-item-link" href="user-profile-settings.html">
                      <i class="mdi mdi-account-group"></i>
                      <span class="nav-text">個人資料</span>
                    </a>
                  </li>


            

            
              
             
        
           
            

            

            
            



  
      </div>
    </aside>

      

      <!-- ====================================
      ——— PAGE WRAPPER
      ===================================== -->
      <div class="page-wrapper">
        
          <!-- Header -->
          <header class="main-header" id="header">
            <nav class="navbar navbar-expand-lg navbar-light" id="navbar">
              <!-- Sidebar toggle button -->
              <button id="sidebar-toggler" class="sidebar-toggle">
                <span class="sr-only">Toggle navigation</span>
              </button>

              <span class="page-title">新增帳單</span>

              <div class="navbar-right ">

</div>
</nav>
</header>







        <div class="content-wrapper"> 
          <div class="content">        
                    <div class="card card-default" id="user-acquisition">
                      <div class="card-header border-bottom pb-0">
                        <h2>新增收入</h2>
                        <ul class="nav nav-underline-active-primary">
                          <li class="nav-item">
                            <a class="nav-link" d href="createBill.html"  aria-selected="false">支出</a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link active"  href="createBill2.html"  aria-selected="true">收入</a>
                        </ul>
                      </div>

                      <form id="form1">
                      <div class="row-cols-sm-1">
                          &nbsp;金額:
                        <input name="money_text" type="text" id="money_text" style="width:200px; margin-left: 10px" required pattern="^\d+$"/><!--非負數-->
                        </div>  
                        
                        <!-- <div>
                          &nbsp;名稱:
                        <input name="name_text" type="text" id="name_text" style="width:200px; margin-left: 10px" required/>	
                        </div> -->
    
                        <div>
                          &nbsp;類別:
                        <select name="type_list1" id="type_list1" style="width:100px; margin-left: 10px">
                          <!-- <option value="薪水">薪水</option> -->
                        
                        </select>
                            <input type="button" id="show" value="新增類別">
                            <input type="button" value="刪除類別" onclick="delOption()">
                            <dialog id="infoModal" style="left:50%; top: 40%;">
                            <p>
                              類別: <input id=item1_Text value="">
                              <input type="button" value="新增" onclick="addOption(item1_Text.value)">
                            </p>
                            <input type="button" id="close" value="關閉">
                            </dialog>
                        </div>  
                                                  
                        <div>
                          &nbsp;日期:
                          <input type="date"  id="date_picker"  name="record_date" value="2023-01-01" min="2023-01-01" max="2053-12-31" style="margin-left: 10px" />  
                        </div>            
                                
                                
                         <!-- <div>      
                          &nbsp;時間:
                        <select name="time_list1" id="time_list1" style="width:100px; margin-left: 10px">
                  <option value="00">00</option>
                  <option value="01">01</option>
                  <option value="02">02</option>
                  <option value="03">03</option>
                  <option value="04">04</option>
                  <option value="05">05</option>
                  <option value="06">06</option>
                  <option value="07">07</option>
                  <option value="08">08</option>
                  <option value="09">09</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <option value="13">13</option>
                  <option value="14">14</option>
                  <option value="15">15</option>
                  <option value="16">16</option>
                  <option value="17">17</option>
                  <option value="18">18</option>
                  <option value="19">19</option>
                  <option value="20">20</option>
                  <option value="21">21</option>
                  <option value="22">22</option>
                  <option value="23">23</option>
                
                </select>
                                        : <select name="time_list2" id="time_list2" style="width:100px; margin-left: 10px">
                  <option value="00">00</option>
                  <option value="01">01</option>
                  <option value="02">02</option>
                  <option value="03">03</option>
                  <option value="04">04</option>
                  <option value="05">05</option>
                  <option value="06">06</option>
                  <option value="07">07</option>
                  <option value="08">08</option>
                  <option value="09">09</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <option value="13">13</option>
                  <option value="14">14</option>
                  <option value="15">15</option>
                  <option value="16">16</option>
                  <option value="17">17</option>
                  <option value="18">18</option>
                  <option value="19">19</option>
                  <option value="20">20</option>
                  <option value="21">21</option>
                  <option value="22">22</option>
                  <option value="23">23</option>
                  <option value="24">24</option>
                  <option value="25">25</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="30">30</option>
                  <option value="31">31</option>
                  <option value="32">32</option>
                  <option value="33">33</option>
                  <option value="34">34</option>
                  <option value="35">35</option>
                  <option value="36">36</option>
                  <option value="37">37</option>
                  <option value="38">38</option>
                  <option value="39">39</option>
                  <option value="40">40</option>
                  <option value="41">41</option>
                  <option value="42">42</option>
                  <option value="43">43</option>
                  <option value="44">44</option>
                  <option value="45">45</option>
                  <option value="46">46</option>
                  <option value="47">47</option>
                  <option value="48">48</option>
                  <option value="49">49</option>
                  <option value="50">50</option>
                  <option value="51">51</option>
                  <option value="52">52</option>
                  <option value="53">53</option>
                  <option value="54">54</option>
                  <option value="55">55</option>
                  <option value="56">56</option>
                  <option value="57">57</option>
                  <option value="58">58</option>
                  <option value="59">59</option>
                
                </select> 
                        </div>          -->
                                
                        <!-- <div>
                          &nbsp;附件:
                          <input type="file" id="profile_pic" name="profile_pic" accept=".jpg, .jpeg, .png" style="margin-left: 10px"><br>
                        </div> -->
                                
                        <div>
                          <input type="submit"  value="新增" style="width:100px; margin-left:85%" />
                        </div>           
                    </div>
                  </form>
                </div>    
        </div>
        <!-- 帳單 -->
        <div class="content" id="incomeList">
          <div class="row">
            <div class="col-12">
              <div class="card card-default">
                <div class="card-header">
                  <h2>收入</h2>             
                </div>
                <div class="card-body">
                  <div id="productsTable_wrapper" class="dataTables_wrapper no-footer">
                    <div id="productsTable_filter" class="dataTables_filter">
                      <label>
                        <input type="search" id="searchInput" placeholder="Search..." aria-controls="productsTable">
                      </label>
                    </div>
                  <table id="productsTable" class="table table-hover table-product" style="width:100%">
                    <thead>
                      <tr>
                        <th></th>
                        <th>類別</th>
                        <th>年</th>
                        <th>月</th>
                        <th>日</th>
                        <th>金額</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>

                      <tr>
                        <tbody></tbody>
                        <!-- <td class="py-0">
                          <img id=file src="" >
                        </td>
                        <td id="name"></td>
                        <td id="type"></td>
                        <td id="money"></td>
                        <td id="date"></td>
                        <td id="time"></td> -->

                        
                      </tr>
                    </div>
                  </div>

                    <!-- import axios -->
                    <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
                    <!-- Get -->
                    <script>          
                      //get 帳單        
                      async function fetchSorcItems(incom_sorc_id) {
                        try {
                          let response = await axios.get(`https://billapi-6373626296ec.herokuapp.com/Incomsorc/${incom_sorc_id}`);
                          return response.data.sorc_Items;
                        } catch (error) {
                          console.error('Error fetching sorc_Items:', error);
                          return ''; // 如果發生錯誤，返回空字符串
                        }
                      }
                      async function fetchData() {
                        try {
                          let response = await axios.get('https://billapi-6373626296ec.herokuapp.com/income');
                          let tbody = document.querySelector('tbody');
                          tbody.innerHTML = ''; // 清除先前的表格內容
                      
                          for (let i = response.data.length-1; i >= 0; i--) {
                            let income = response.data[i];
                            let id = income.income_id;
                            let money = income.price;
                            let year = moment.utc(income.date).format('YYYY');
                            let month = moment.utc(income.date).format('MM');
                            let day = moment.utc(income.date).format('DD');

                            let incomeSorc = await fetchSorcItems(income.incom_sorc_id);
                      
                            let item = [id,'', incomeSorc,year, month, day, money,""];
                            let tr = document.createElement('tr');
                            
                            item.forEach((value, index) => {
                              let td = document.createElement('td');
                      
                              if (index === item.length - 1) {
                                // 在最後一個元素的 td 中添加下拉菜單
                                let dropdownDiv = document.createElement('div');
                                dropdownDiv.classList.add('dropdown');
                      
                                let dropdownToggle = document.createElement('a');
                                dropdownToggle.classList.add('dropdown-toggle', 'icon-burger-mini');
                                dropdownToggle.href = '#';
                                dropdownToggle.role = 'button';
                                dropdownToggle.id = 'dropdownMenuLink';
                                dropdownToggle.setAttribute('data-toggle', 'dropdown');
                                dropdownToggle.setAttribute('aria-haspopup', 'true');
                                dropdownToggle.setAttribute('aria-expanded', 'false');
                      
                                dropdownDiv.appendChild(dropdownToggle);
                      
                                let dropdownMenu = document.createElement('div');
                                dropdownMenu.classList.add('dropdown-menu', 'dropdown-menu-right');
                                dropdownMenu.setAttribute('aria-labelledby', 'dropdownMenuLink');
                      
                                // 添加下拉菜單的內容
                                let menuItems = ["編輯","刪除"];
                      
                                menuItems.forEach((item, index) => {
                                  let menuItem = document.createElement('a');
                                  menuItem.classList.add('dropdown-item');
                                  //menuItem.href = '#';
                                  menuItem.innerHTML = item;

                                  let editing=0
                                  let edited=0;
                                  // 點擊編輯或刪除時
                                  menuItem.addEventListener('click', function () {
                                    if (index === 0) {
                                      // 編輯
                                      // 取得當前row的所有 td 元素
                                      let tds = tr.getElementsByTagName('td');
                                      
                                      if(editing==0){
                                          // 迴圈遍歷 td 元素
                                        for (let j = 2; j < tds.length - 1; j++) {
                                          if(j==2){
          
                                            let select = document.createElement('select');
                                            select.name = 'editedType'; // 賦予下拉選單一個名稱
                                            select.style.width = '100px';
          
                                            // 將 type_list1 的選項添加到下拉選單
                                            let typeList1Options = document.getElementById('type_list1').options;
                                            for (let i = 0; i < typeList1Options.length; i++) {
                                                let option = document.createElement('option');
                                                option.value = typeList1Options[i].value;
                                                option.text = typeList1Options[i].text;
                                                select.add(option);
                                            }
          
                                            // 選擇下拉選單的預設值為原本的類別
                                            let originalType = tds[2].innerText;
                                            select.value = originalType;
                                            tds[2].innerHTML = '';
                                            tds[2].appendChild(select);
                                          
                                          }else{ 
                                            let input = document.createElement('input');
                                            input.type = 'text';
                                            input.value = tds[j].innerText; // 使用原本的內容設定 input 的初始值
                                            input.style.width = '40px';
                                            tds[j].innerHTML = ''; // 清空 td 的內容
                                            tds[j].appendChild(input);
                                            menuItem.innerHTML = "儲存";
                                            
                                          }                              
                                        }
                                        editing=1;
                                        console.log(1);
                                      }else if(editing==1){//編輯中
                                        let isValid = validateInputs(tds); // 驗證所有輸入是否有效                 
                                        if (isValid) {
                                          for (let j = 2; j < tds.length - 1; j++) {
                                            if(j==2){
                                              // 已經是下拉選單，還原為原始文字內容
                                              let originalType = tds[2].querySelector('select').value;
                                              tds[2].innerHTML = originalType;
                                              
                                            }else{
                                              let originalText = tds[j].querySelector('input').value;
                                              if(j==4||j==5){
                                                let intValue = parseInt(originalText, 10);
                                                if (intValue >= 1 && intValue <= 9) {
                                                  // 在數字前面加 '0'
                                                  originalText = intValue < 10 ? '0' + intValue : intValue.toString();
                                                } 
                                              }
                                              
                                              tds[j].innerHTML = originalText;
                                              menuItem.innerHTML = "編輯";
                                            }
                                          }
                                          edited=1;
                                          editing=0;
                                        } else {
                                          alert('請確認符合格式！');
                                        }
                                        
                                      }
                                      //<!-- put -->
                                      if(edited==1){
                                        let updatedData = {
                                          "incom_sorc_id": null,
                                          "member_id": 1,
                                          "price": tds[6].innerText,
                                          "date": tds[3].innerText+'/'+tds[4].innerText+'/'+tds[5].innerText
                                        }
                                        async function updateData() {
                                          try {
                                            let selectedOption = tds[2].innerText;
                                            console.log(selectedOption)
                                            let response = await axios.get('https://billapi-6373626296ec.herokuapp.com/Incomsorc');
                                            let selectedSorcItem = response.data.find(item => item.sorc_Items === selectedOption);                 
                                            // 在此處更新表單
                                            if (selectedSorcItem) {
                                              // 更新 incom_sorc_id
                                              updatedData.incom_sorc_id = selectedSorcItem.incom_sorc_id;
                                               
                                            } else {
                                              console.error('找不到匹配的 incom_sorc。');
                                            }
                                          } catch (error) {
                                            console.error('錯誤:', error);
                                          }
                                        }     
                                        async function Edit() {  
                                          await updateData();
                                          console.log(updatedData)
                                          axios.put(`https://billapi-6373626296ec.herokuapp.com/income/${tds[0].innerText}`, updatedData)
                                          .then(function (response) {
                                            console.log('更新成功:', response.data);
                                          })
                                          .catch(function (error) {
                                            console.error('錯誤:', error);
                                          });
                                        }
                                        Edit();
                                      }
                                    } else if (index === 1) {
                                      //<!-- delete -->
                                      // 刪除
                                      let answer = confirm('確定要刪除嗎？');
                                      if(answer){
                                        Del();
                                      }
                                      async function Del() { 
                                        let tds = tr.getElementsByTagName('td');
                                        await axios.delete(`https://billapi-6373626296ec.herokuapp.com/income/${tds[0].innerText}`)
                                        .then(function (response) {
                                          console.log('刪除成功:', response.data);
                                        })
                                        .catch(function (error) {
                                          console.error('錯誤:', error);
                                        });
                                        fetchData();
                                      }
                                      
                                    }
                                  });
                                
                                  dropdownMenu.appendChild(menuItem);
                                  dropdownDiv.appendChild(dropdownMenu);
                                  td.appendChild(dropdownDiv);
                                });
                              } else {
                                td.innerHTML = value;
                              }
                              //隱藏id
                              if (index === 0) {
                                td.style.display = 'none';
                              }
                              tr.appendChild(td);
                            });
                      
                            tbody.appendChild(tr);
                          }
                        } catch (error) {
                          console.error('Error fetching data:', error);
                        }
                      }                     
                      fetchData();
                       
                      // 驗證編輯的所有輸入是否有效的函數
                      function validateInputs(tds) {
                        for (let j = 2; j < tds.length - 1; j++) {                   
                          if(j!=2){                      
                            let input=tds[j].querySelector('input').value
                            if (!input || input.trim() === '') {
                              console.log(input);
                              return false; // 如果有空白輸入，返回 false
                            }
                          }
                          if(j==4){
                            let input = tds[j].querySelector('input').value;
                            let intValue = parseInt(input, 10);
                
                            if (isNaN(intValue) || intValue < 1 || intValue > 12) {
                                console.log(input);
                                return false; // 如果不在 1 到 12 的範圍內，返回 false
                            }
                          } 
                          if(j==5){
                            let input = tds[j].querySelector('input').value;
                            let intValue = parseInt(input, 10);
                
                            if (isNaN(intValue) || intValue < 1 || intValue > 31) {
                                console.log(input);
                                return false; // 如果不在 1 到 31 的範圍內，返回 false
                            }
                          }                                                                       
                          if(j==6){
                            let input = tds[j].querySelector('input').value;
                            let intValue = parseInt(input, 10);

                            if (isNaN(intValue) || intValue <= 0) {
                                console.log(input);
                                return false; // 如果不是正整數，返回 false
                            }
                          }                                                                                   
                        }                      
                        return true; 
                      }


                      async function initialize() {
                        await getSorc(); // 等待 getSorc 完成
                        updateIncomeJSON(); // getSorc 完成後再執行 updateIncomeJSON
                      }                      
                      initialize(); // 調用初始化函數
                      //get 類別
                      async function getSorc() {
                        try {
                          let response = await axios.get('https://billapi-6373626296ec.herokuapp.com/Incomsorc');
                          let typeList1 = document.getElementById('type_list1');
                      
                          // 清空現有的選項
                          typeList1.innerHTML = '';
                      
                          // 迭代 sorc_Items 並添加到下拉選單
                          response.data.forEach(function (item) {
                            let option = document.createElement('option');
                            option.value = item.sorc_Items;
                            option.textContent = item.sorc_Items;
                            typeList1.appendChild(option);
                          });
                          // 設定第一項為預設選中
                          typeList1.selectedIndex = 0;
                        } catch (error) {
                          // 錯誤處理
                          console.error('錯誤:', error);
                        }
                      }                    
                      getSorc();
                    </script>

                    <!-- post -->
                    <script>
                      let incomeJSON = {
                        "incom_sorc_id": null,
                        "member_id": 1,
                        "price": null,
                        "date": null
                      };                     
                      document.getElementById('type_list1').addEventListener('change', function () {
                        updateIncomeJSON();
                      });                                         
                      async function updateIncomeJSON() {
                        try {
                          let selectedOption = document.getElementById('type_list1').value;
                          let response = await axios.get('https://billapi-6373626296ec.herokuapp.com/Incomsorc');
                          let selectedSorcItem = response.data.find(item => item.sorc_Items === selectedOption);                     
                          // 在此處更新表單
                          if (selectedSorcItem) {
                            // 更新 incomeJSON 的 incom_sorc_id
                            incomeJSON.incom_sorc_id = selectedSorcItem.incom_sorc_id;
                          } else {
                            console.error('找不到匹配的 sorc_Items。');
                            // 可能需要進行錯誤處理
                          }
                        } catch (error) {
                          // 錯誤處理
                          console.error('錯誤:', error);
                        }
                      }                   
                      const form = document.getElementById('form1');
                      form.addEventListener('submit', (event) => {
                        event.preventDefault()
                        // 更新 incomeJSON 的其他屬性
                        incomeJSON.price = document.getElementById("money_text").value;
                        incomeJSON.date = document.getElementById("date_picker").value;
                        console.log(incomeJSON)
                        // 在這裡使用更新後的 incomeJSON 進行 POST 請求
                        async function AddIcome(){
                          await axios.post('https://billapi-6373626296ec.herokuapp.com/income', incomeJSON)
                            .then(function (response) {
                              // 成功處理回應
                              console.log('成功:', response.data);
                            })
                            .catch(function (error) {
                              // 錯誤處理
                              console.error('錯誤:', error);
                            });
                          fetchData();
                        }
                        AddIcome();
                      });
                       
                      //post 類別
                      function addOption(text){
                        let sorc_Item={
                          "member_id": 1,
                          "sorc_Items": text
                        }
                        checkcItem();
                        async function checkcItem() {
                          try {
                            let selectedOption = text;
                            console.log(selectedOption)
                            let response = await axios.get('https://billapi-6373626296ec.herokuapp.com/Incomsorc');
                            let selectedSorcItem = response.data.find(item => item.sorc_Items === selectedOption);                 

                            if (selectedSorcItem) {
                              console.error('已存在sorc_Item');
                            } else {
                              Addsorc_Item();
                            }
                          } catch (error) {
                            console.error('錯誤:', error);
                          }
                        }     

                        async function Addsorc_Item(){
                          await axios.post('https://billapi-6373626296ec.herokuapp.com/Incomsorc', sorc_Item)
                          .then(function (response) {
                            // 成功處理回應
                            console.log('成功:', response.data);
                          })
                          .catch(function (error) {
                            // 錯誤處理
                            console.error('錯誤:', error);
                          });
                          getSorc();
                        }
                      }           
                      //del 類別
                      async function delOption(){
                        let answer = confirm('確定要刪除嗎？');
                        if(answer){   
                          let selectedOption = document.getElementById('type_list1').value;
                          let response = await axios.get('https://billapi-6373626296ec.herokuapp.com/Incomsorc');
                          let selectedSorcItem = response.data.find(item => item.sorc_Items === selectedOption);                 
                          if (selectedSorcItem) {
                            await axios.delete(`https://billapi-6373626296ec.herokuapp.com/Incomsorc/${selectedSorcItem.incom_sorc_id}`)
                            .then(function (response) {
                              console.log('成功:', response.data);
                            })
                            .catch(function (error) {
                              console.error('錯誤:', error);
                            });
                            getSorc();
                          } else {
                            console.error('找不到匹配的 sorc_Items。');
                          }
                       }
                      }       
                    </script>


                    <script>
                      //類別視窗
                      let btn=document.querySelector("#show");
                      let infoModal=document.querySelector("#infoModal");
                      let close=document.querySelector("#close");
                      btn.addEventListener("click", function(){
                        infoModal.showModal();
                      })
                      close.addEventListener("click", function(){
                        infoModal.close();
                      })
                      //預設今日
                      var today = new Date();
                      var dd = String(today.getDate()).padStart(2, '0');
                      var mm = String(today.getMonth() + 1).padStart(2, '0');
                      var yyyy = today.getFullYear();
                      today = yyyy + '-' + mm + '-' + dd;
                      document.getElementById("date_picker").value = today;

                      //搜尋帳單
                      function searchBill(){
                        // 獲取 input 元素
                        const searchInput = document.getElementById('searchInput');

                        // 監聽 input 元素的 input 事件
                        searchInput.addEventListener('input', function () {
                            // 獲取搜索關鍵詞
                            const searchTerm = searchInput.value.toLowerCase();

                            // 獲取表格的 tbody 元素
                            const tbody = document.querySelector('tbody');

                            const rows = tbody.getElementsByTagName('tr');

                            for (let i = 0; i < rows.length; i++) {
                                const row = rows[i];
                                const cells = row.getElementsByTagName('td');

                                row.style.display = '';
                                console.log(cells[0].innerText)
                                // 迭代每一個單元格
                                for (let j = 2; j < cells.length; j++) {
                                    const cellText = cells[j].textContent || cells[j].innerText;
                                
                                    // 如果單元格的文本不包含搜索關鍵詞，隱藏該行
                                    if (cellText.toLowerCase().indexOf(searchTerm) === -1) {
                                      row.style.display = 'none';
                                    }else{
                                      row.style.display = '';
                                      break;
                                    }
                                }
                            }
                        });
                      }
                      searchBill();
                    </script>

                    <script src="plugins/jquery/jquery.min.js"></script>
                    <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
                    <script src="plugins/simplebar/simplebar.min.js"></script>
                    <script src="https://unpkg.com/hotkeys-js/dist/hotkeys.min.js"></script>

                    
                    
                    <script src="plugins/apexcharts/apexcharts.js"></script>
                    
                    
                    
                    <script src="plugins/jvectormap/jquery-jvectormap-2.0.3.min.js"></script>
                    <script src="plugins/jvectormap/jquery-jvectormap-world-mill.js"></script>
                    <script src="plugins/jvectormap/jquery-jvectormap-us-aea.js"></script>
                    
                    
                    
                    
                    
                    <script src="plugins/daterangepicker/moment.min.js"></script>
                    <script src="plugins/daterangepicker/daterangepicker.js"></script>
                    
                    
                    
                    <script src="js/mono.js"></script>
                    <script src="js/map.js"></script>
                    <script src="js/custom.js"></script>

                    

                    <!--  -->


  </body>
</html>
